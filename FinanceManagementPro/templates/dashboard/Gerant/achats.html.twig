{% extends 'base.html.twig' %}

{% block title %}
    Achats/Fournisseurs
{% endblock %}

{% block body %}
    <h1 class="text-3xl font-semibold text-gray-900 mb-6 text-center">
        Factures fournisseurs en attente d'action
    </h1>
    
    <div class="bg-white rounded shadow p-6 mb-10">
        <h2 class="text-xl font-bold text-gray-800 mb-4">
            Factures en attente d'action
        </h2>

        {% set factures_attente = [
            {
                'fournisseur': 'Arnaqueur',
                'ref': 'Facture - 69777',
                'date': '22 Oct 2025',
                'montant': '58 974 €',
                'statut': 'En attente validation',
                'action': ['Approuver', 'Refuser']
            },
            {
                'fournisseur': 'SNCF',
                'ref': 'Facture - 98005',
                'date': '21 Oct 2025',
                'montant': '666 €',
                'statut': 'En attente de paiement',
                'action': ['Payer Maintenant']
            },
            {
                'fournisseur': 'Dior',
                'ref': 'Facture - 69619',
                'date': '20 Oct 2025',
                'montant': '1 248 €',
                'statut': 'Validé',
                'action': ['Télécharger le Justificatif']
            }
        ] %}

        <table class="min-w-full text-sm text-left">
            <thead class="bg-gray-100 text-gray-600 uppercase">
                <tr>
                    <th class="px-4 py-2">Fournisseur</th>
                    <th class="px-4 py-2">Facture</th>
                    <th class="px-4 py-2">Date</th>
                    <th class="px-4 py-2">Montant</th>
                    <th class="px-4 py-2">Statut</th>
                    <th class="px-4 py-2">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for f in factures_attente %}
                    <tr class="border-t">
                        <td class="px-4 py-2">{{ f.fournisseur }}</td>
                        <td class="px-4 py-2">{{ f.ref }}</td>
                        <td class="px-4 py-2">{{ f.date }}</td>
                        <td class="px-4 py-2">{{ f.montant }}</td>
                        <td class="px-4 py-2">{{ f.statut }}</td>
                        <td class="px-4 py-2">
                            <div class="flex gap-2 flex-wrap">
                                {% for a in f.action %}
                                    {% set btn_class = 'bg-indigo-600 hover:bg-indigo-700' %}
                                    {% if a == 'Approuver' %}
                                        {% set btn_class = 'bg-green-600 hover:bg-green-700' %}
                                    {% elseif a == 'Refuser' %}
                                        {% set btn_class = 'bg-red-600 hover:bg-red-700' %}
                                    {% elseif a == 'Télécharger le Justificatif' %}
                                        {% set btn_class = 'bg-black hover:bg-gray-800' %}
                                    {% endif %}
                                    <button class="{{ btn_class }} text-white px-3 py-1 rounded text-xs">{{ a }}</button>
                                {% endfor %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="bg-white rounded shadow p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-4">
            Historique des Factures
        </h2>

        {% set factures_hist = [
            {
                'fournisseur': 'OVH',
                'ref': 'Facture - 59000',
                'date': '1 Nov 2025',
                'montant': '800 €',
                'statut': 'Dépense',
                'action': ['Voir Facture']
            },
            {
                'fournisseur': 'Google Ads',
                'ref': 'Facture - 59101',
                'date': '29 Oct 2025',
                'montant': '5 872 €',
                'statut': 'Dépense',
                'action': ['Voir Facture']
            }
        ] %}

        <table class="min-w-full text-sm text-left">
            <thead class="bg-gray-100 text-gray-600 uppercase">
                <tr>
                    <th class="px-4 py-2">Fournisseur</th>
                    <th class="px-4 py-2">Facture</th>
                    <th class="px-4 py-2">Date</th>
                    <th class="px-4 py-2">Montant</th>
                    <th class="px-4 py-2">Statut</th>
                    <th class="px-4 py-2">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for f in factures_hist %}
                    <tr class="border-t">
                        <td class="px-4 py-2">{{ f.fournisseur }}</td>
                        <td class="px-4 py-2">{{ f.ref }}</td>
                        <td class="px-4 py-2">{{ f.date }}</td>
                        <td class="px-4 py-2">{{ f.montant }}</td>
                        <td class="px-4 py-2">{{ f.statut }}</td>
                        <td class="px-4 py-2">
                            <div class="flex gap-2 flex-wrap">
                                {% for a in f.action %}
                                    <button class="bg-indigo-600 text-white px-3 py-1 rounded text-xs hover:bg-indigo-700">{{ a }}</button>
                                {% endfor %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
